<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>聊天室主页面</title>
    <link rel="stylesheet" href="./index.css">
</head>
<body>
    <!-- 主容器 -->
    <div class="main-container">
        <!-- 登录界面 -->
        <div id="login-container" class="login-container">
            <div class="login-box">
                <h1>欢迎来到聊天室</h1>
                <p>请输入4位数字进入聊天室</p>
                <div class="code-input-container">
                    <input type="text" id="room-code" maxlength="4" placeholder="输入4位房间号">
                </div>
                <button id="enter-button" class="enter-button">进入聊天室</button>
                <p id="error-message" class="error-message"></p>
            </div>
        </div>

        <!-- 聊天室主界面 (初始隐藏) -->
        <div id="chat-main" class="chat-main" style="display: none;">
            <!-- 顶部导航栏 -->
            <div class="top-nav">
                <button id="toggle-history" class="nav-button">历史聊天室</button>
                <h2 id="current-room-title">聊天室</h2>
                <button id="toggle-profile" class="nav-button">个人信息</button>
            </div>

            <!-- 聊天内容区域 -->
            <div class="chat-content">
                <!-- 这里将嵌入现有的聊天室内容 -->
                <div class="chat-frame">
                    <iframe id="chat-iframe" src="" frameborder="0"></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- 左侧抽屉 - 历史聊天室 -->
    <div id="history-drawer" class="drawer drawer-left">
        <div class="drawer-header">
            <h3>历史聊天室</h3>
            <button id="close-history" class="close-button">×</button>
        </div>
        <div class="drawer-content">
            <ul id="history-list" class="history-list">
                <!-- 历史聊天室列表将通过JavaScript动态生成 -->
                <li class="history-list-item">暂无历史记录</li>
            </ul>
        </div>
    </div>

    <!-- 右侧抽屉 - 个人信息 -->
    <div id="profile-drawer" class="drawer drawer-right">
        <div class="drawer-header">
            <h3>个人信息</h3>
            <button id="close-profile" class="close-button">×</button>
        </div>
        <div class="drawer-content">
            <div class="profile-info">
                <div class="profile-avatar">
                    <div id="avatar-placeholder" class="avatar-placeholder">用户</div>
                </div>
                <div class="profile-details">
                    <p><strong>用户名:</strong> <span id="profile-username">加载中...</span></p>
                    <p><strong>用户ID:</strong> <span id="profile-userid">加载中...</span></p>
                    <p><strong>上次登录:</strong> <span id="profile-lastlogin">加载中...</span></p>
                </div>
            </div>
            <div class="profile-actions">
                <div class="profile-edit-form">
                    <h4>编辑个人信息</h4>
                    <div class="form-group">
                        <label for="nickname-input">昵称:</label>
                        <input type="text" id="nickname-input" placeholder="请输入昵称">
                    </div>
                    <div class="form-group">
                        <label for="gender-select">性别:</label>
                        <select id="gender-select">
                            <option value="">请选择</option>
                            <option value="male">男</option>
                            <option value="female">女</option>
                            <option value="other">其他</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="age-input">年龄:</label>
                        <input type="number" id="age-input" min="1" max="149" placeholder="请输入年龄">
                    </div>
                    <div class="form-group">
                        <label for="region-input">地区:</label>
                        <input type="text" id="region-input" placeholder="请输入地区">
                    </div>
                    <button id="save-profile-btn" class="save-profile-btn">保存设置</button>
                </div>
                <button id="logout-button" class="logout-button">退出登录</button>
            </div>
        </div>
    </div>

    <!-- 遮罩层 -->
    <div id="overlay" class="overlay" style="display: none;"></div>

    <!-- 导入必要的库 -->
    <script src="./load_supabase.js"></script>
    <script src="./index.js"></script>
</body>
</html>